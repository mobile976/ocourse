{% extends "base.html" %}
{% block title %}–ù–∏–π—Ç –≥–∏—à“Ø“Ø–¥{% endblock %}

{% block content %}
{% include "partials/slide_detail.html" with title="–ù–∏–π—Ç –≥–∏—à“Ø“Ø–¥" %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
    <span class="text-muted small">
      –ù–∏–π—Ç: {{ profiles|length|default:"0" }} –≥–∏—à“Ø“Ø–¥ –±–∞–π–Ω–∞.
    </span>
  </div>

  {% if profiles %}
  <div class="row g-4">

    {% for profile in profiles %}
    <div class="col-md-6 col-lg-4 col-xl-3">
      <div class="card shadow-sm h-100">

        <div class="text-center pt-3 pb-2">
          {% if profile.profile_picture %}
          <img src="{{ profile.profile_picture }}" alt="Avatar" class="rounded-circle shadow-sm"
            style="width:80px; height:80px; object-fit:cover;">
          {% else %}
          <div
            class="rounded-circle bg-secondary text-white d-flex align-items-center justify-content-center mx-auto shadow-sm"
            style="width:80px; height:80px; font-size:1.4rem;">
            {{ profile.user.username|slice:":1"|upper }}
          </div>
          {% endif %}
        </div>

        <div class="card-body pt-1 pb-2 text-center">

          <h5 class="card-title mb-1">
              {{ profile.user.username }}
          </h5>

          {% if profile.subscription_level %}
          <span class="badge text-bg-primary mb-2">
            {{ profile.get_subscription_level_display }}
          </span>
          {% else %}
          <span class="badge text-bg-secondary mb-2">Free</span>
          {% endif %}

          <p class="small text-muted mb-1">
            üìû {{ profile.phone_number|default:"–£—Ç–∞—Å–Ω—ã –º—ç–¥—ç—ç–ª—ç–ª –±–∞–π—Ö–≥“Ø–π" }}
          </p>
        </div>

        <div class="card-footer bg-light small">

          <div class="mb-2 text-muted">
            üóì –ë“Ø—Ä—Ç–≥—ç–≥–¥—Å—ç–Ω: {{ profile.created_at|date:"Y-m-d" }}
          </div>

          {% with user_courses=profile.user.courses.all %}
          {% if user_courses %}
          <div class="fw-semibold">üìò –û—Ä—É—É–ª—Å–∞–Ω —Ö–∏—á—ç—ç–ª“Ø“Ø–¥:</div>

          <div style="max-height: 110px; overflow-y: auto;" class="mt-1">

            <ul class="list-unstyled mb-0">
              {% for c in user_courses %}
              <li>
                <a href="{% url 'course_detail' c.pk %}" class="text-decoration-none">
                  ‚Ä¢ {{ c.title|truncatechars:40 }}
                </a>
              </li>
              {% endfor %}
            </ul>

          </div>
          {% else %}
          <div class="text-muted">
            üìò –û—Ä—É—É–ª—Å–∞–Ω —Å—É—Ä–≥–∞–ª—Ç –±–∞–π—Ö–≥“Ø–π.
          </div>
          {% endif %}
          {% endwith %}

        </div>
      </div>
    </div>
    {% endfor %}

  </div>

  {% else %}
  <div class="alert alert-info">–ü—Ä–æ—Ñ–∞–π–ª –∞–ª–≥–∞.</div>
  {% endif %}

</div>
{% endblock %}